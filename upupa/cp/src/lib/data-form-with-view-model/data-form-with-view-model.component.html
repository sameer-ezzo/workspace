<!-- label -->
@if (label()) {
    <label style="margin-block: 0.5rem 1rem">{{ label() }}</label>
}
<div class="form-wrapper">
    @let _vm = viewModel();

    <dynamic-form
        #dynForm
        [fields]="_vm.fields"
        [(value)]="value"
        (fieldValueChange)="onValueChange($event)"
        [formName]="_vm.name"
        [preventDirtyUnload]="_vm.preventDirtyUnload"
        [theme]="_vm.theme"
        [conditions]="_vm.conditions"
        [formName]="name()"
        (submit)="onSubmit()"
        [form]="form()"
        [formGroup]="form()"
    ></dynamic-form>
</div>

@if (actions()?.length) {
    <div class="toolbar footer">
        @for (descriptor of actions(); track descriptor.name) {
            @if (descriptor.type == "submit") {
                <mat-btn
                    [descriptor]="descriptor"
                    [loading]="submitting()"
                    (onClick)="dynForm.ngSubmit()"
                    [disabled]="this.submitting() || (dynForm.invalid && (dynForm.dirty || dynForm.touched))"
                >
                </mat-btn>
            } @else {
                <mat-btn [descriptor]="descriptor" (onClick)="onAction($event)"></mat-btn>
            }
        }
    </div>
}
