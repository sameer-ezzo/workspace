<!-- label -->
@if (label()) {
    <label style="margin-block: 0.5rem 1rem">{{ label() }}</label>
}
<div class="form-wrapper">
    @let _vm = viewModel();

    <dynamic-form
        #dynForm
        [(value)]="value"
        [fields]="_vm.fields"
        (fieldValueChange)="onValueChange($event)"
        (initialized)="onInitialized($event)"
        [name]="formName()"
        [preventDirtyUnload]="_vm.preventDirtyUnload"
        [theme]="_vm.theme"
        [conditions]="_vm.conditions"
        (submitted)="onSubmit()"
        [control]="control()"
    ></dynamic-form>
    <!-- [formGroup]="control()" -->
</div>

@if (actions()?.length) {
    <div class="toolbar footer">
        @for (descriptor of actions(); track descriptor.name) {
            @if (descriptor.type == "submit") {
                <mat-btn
                    [buttonDescriptor]="descriptor"
                    [loading]="submitting()"
                    (click)="dynForm.submit()"
                    [disabled]="this.submitting() || (dynForm.invalid && (dynForm.dirty || dynForm.touched))"
                >
                </mat-btn>
            } @else {
                <mat-btn [buttonDescriptor]="descriptor" (click)="onAction($event)"></mat-btn>
            }
        }
    </div>
}
